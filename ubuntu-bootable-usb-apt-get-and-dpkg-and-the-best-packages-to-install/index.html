<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="john pfeiffer" />
        <meta name="copyright" content="john pfeiffer" />

<meta name="keywords" content="linux, ubuntu, xubuntu, usb boot, ubuntu recovery, dpkg, apt-get, dd, linux, " />
        <title>Ubuntu Bootable USB, apt-get and dpkg, and the best packages to install  · johnpfeiffer
</title>
        <!--link href="https://cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css"-->
        <!--link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet"-->
        <link href="https://blog.john-pfeiffer.com/theme/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://blog.john-pfeiffer.com/theme/css/style.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://blog.john-pfeiffer.com/theme/css/solarizedlight.css" media="screen">
        <link rel="shortcut icon" href="https://blog.john-pfeiffer.com/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="apple-touch-icon" href="https://blog.john-pfeiffer.com/theme/images/apple-touch-icon.png" />
        <link rel="apple-touch-icon" sizes="57x57" href="https://blog.john-pfeiffer.com/theme/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="https://blog.john-pfeiffer.com/theme/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="https://blog.john-pfeiffer.com/theme/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon" sizes="144x144" href="https://blog.john-pfeiffer.com/theme/images/apple-touch-icon-144x144.png" />
        <link rel="icon" href="https://blog.john-pfeiffer.com/theme/images/apple-touch-icon-144x144.png" />
    </head>
    <body>
	<div id="content-sans-footer">
        <div class="dropdown-backdrop">

			<div class="navbar navbar-static-top">
				<div class="navbar-inner">
					<div class="container">
						<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</a>
						<a class="brand" href="https://blog.john-pfeiffer.com/"><span class=site-name>johnpfeiffer</span></a>
						<div class="nav-collapse collapse">
							<ul class="nav pull-right top-menu">
								<li ><a href="https://blog.john-pfeiffer.com">Home</a></li>
								<li ><a href="https://blog.john-pfeiffer.com/john-likes/">John Likes</a></li>
								<li ><a href="https://blog.john-pfeiffer.com/categories.html">Categories</a></li>
								<li ><a href="https://blog.john-pfeiffer.com/tags.html">Tags</a></li>
								<li ><a href="https://blog.john-pfeiffer.com/archives.html">Archives</a></li>
								<li><form class="navbar-search" action="https://blog.john-pfeiffer.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="container-fluid">
			<div class="row-fluid">
				<div class="span1"></div>
				<div class="span10">
<article>
<div class="row-fluid">
    <header class="page_header span10 offset2">
    <h1><a href="https://blog.john-pfeiffer.com/ubuntu-bootable-usb-apt-get-and-dpkg-and-the-best-packages-to-install/"> Ubuntu Bootable USB, apt-get and dpkg, and the best packages to install  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <p>[TOC]</p>
<p>If you have a modern computer (BIOS) that can boot from USB it is well worth it since having the latest Ubuntu ISO on DVD tends to pile up extra plastic.</p>
<p>After setting up the Operating System you will need to install some software (packages).</p>
<p>And if you have an SSD drive you will want to optimize your OS to not wear it out unnecessarily.</p>
<h2>Write an ISO to usb</h2>
<p>Be very careful with <strong>sudo</strong> or using the <strong>root</strong> user as this can permanently remove files or render your operating system inoperable.</p>
<p><em>dd is a low level command that writes bytes directly without any prompts</em></p>
<div class="highlight"><pre><span></span><code><span class="nv">sudo</span> <span class="nv">su</span>
<span class="nv">fdisk</span> <span class="o">-</span><span class="nv">l</span>
<span class="nv">umount</span> <span class="o">/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdc1</span>

<span class="nv">dd</span> <span class="k">if</span><span class="o">=/</span><span class="nv">home</span><span class="o">/</span><span class="nv">ubuntu</span><span class="o">/</span><span class="nv">Desktop</span><span class="o">/</span><span class="nv">ubuntu</span><span class="o">-</span><span class="mi">14</span>.<span class="mi">04</span>.<span class="mi">1</span><span class="o">-</span><span class="nv">server</span><span class="o">-</span><span class="nv">amd64</span>.<span class="nv">iso</span> <span class="nv">of</span><span class="o">=/</span><span class="nv">dev</span><span class="o">/</span><span class="nv">sdc</span>

<span class="mi">1171456</span><span class="o">+</span><span class="mi">0</span> <span class="nv">records</span> <span class="nv">in</span>
<span class="mi">1171456</span><span class="o">+</span><span class="mi">0</span> <span class="nv">records</span> <span class="nv">out</span>
<span class="mi">599785472</span> <span class="nv">bytes</span> <span class="ss">(</span><span class="mi">600</span> <span class="nv">MB</span><span class="ss">)</span> <span class="nv">copied</span>, <span class="mi">260</span>.<span class="mi">364</span> <span class="nv">s</span>, <span class="mi">2</span>.<span class="mi">3</span> <span class="nv">MB</span><span class="o">/</span><span class="nv">s</span>
</code></pre></div>

<blockquote>
<p>fdisk allows you to see the device (e.g. an 8GB usb stick)</p>
<p>dd will overwrite from the "infile" to the "outfile" so make sure you get that target location correct!</p>
</blockquote>
<h2>Ubuntu Recovery mode</h2>
<p>(which is access to a single root user command line)</p>
<p>boot in recovery mode by using the arrow keys during boot (down to select Recovery)</p>
<ol>
<li>mount networking </li>
<li>root shell<ul>
<li><code>mount -o rw,remount /</code></li>
</ul>
</li>
</ol>
<blockquote>
<p>mount --all # might be needed too</p>
</blockquote>
<p>Now you can fix grub or /etc/passwd or free up some hard drive space</p>
<h2>package management with apt commands</h2>
<p>Debian has precompiled packages of binaries and libraries that can very easily be installed via the command line (or GUI) using Advanced Packaging Tool (APT) </p>
<p><a href="https://wiki.debian.org/Apt">https://wiki.debian.org/Apt</a></p>
<p>Since apt is a wonderful wrapper/manager of dpkg when you're in doubt most likely there is a dpkg command that will do what you need but it may take a lot of research and 8 parameters to do it ;]</p>
<p><a href="https://en.wikipedia.org/wiki/Advanced_Packaging_Tool">https://en.wikipedia.org/wiki/Advanced_Packaging_Tool</a></p>
<p><em>Hint: Ubuntu is based upon Debian</em></p>
<h3>apt-cache</h3>
<div class="highlight"><pre><span></span><code>apt-cache search ssh
</code></pre></div>

<blockquote>
<p>to find packages with the name ssh</p>
</blockquote>
<div class="highlight"><pre><span></span><code>apt-cache search ssh | grep server
</code></pre></div>

<blockquote>
<p>if there are too many results pipe to grep to filter down the results</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="nv">apt</span><span class="o">-</span><span class="nv">cache</span> <span class="k">show</span> <span class="nv">ssh</span>
</code></pre></div>

<blockquote>
<p>to show the details about a specific package</p>
</blockquote>
<div class="highlight"><pre><span></span><code>apt-cache showpkg ssh
</code></pre></div>

<blockquote>
<p>to show more general info about a package</p>
</blockquote>
<div class="highlight"><pre><span></span><code>apt-cache depends ssh
</code></pre></div>

<blockquote>
<p>to show the package dependencies</p>
</blockquote>
<h3>Force Apt to use  IPv4 to avoid lengthy IPv6 timeouts</h3>
<div class="highlight"><pre><span></span><code><span class="nt">sudo</span> <span class="nt">apt-get</span> <span class="nt">-o</span> <span class="nt">Acquire</span><span class="p">::</span><span class="nd">ForceIPv4</span><span class="o">=</span><span class="nt">true</span> <span class="nt">update</span>
<span class="nt">sudo</span> <span class="nt">apt-get</span> <span class="nt">-o</span> <span class="nt">Acquire</span><span class="p">::</span><span class="nd">ForceIPv4</span><span class="o">=</span><span class="nt">true</span> <span class="nt">install</span> <span class="nt">vim</span>
<span class="nt">sudo</span> <span class="nt">echo</span> <span class="s1">&#39;Acquire::ForceIPv4 &quot;true&quot;;&#39;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="nt">etc</span><span class="o">/</span><span class="nt">apt</span><span class="o">/</span><span class="nt">apt</span><span class="p">.</span><span class="nc">conf</span><span class="p">.</span><span class="nc">d</span><span class="o">/</span><span class="nt">99force-ipv4</span>
</code></pre></div>

<blockquote>
<p>update, then install vim, then save the persistent config to always use ipv4</p>
</blockquote>
<h3>apt-get</h3>
<h4>updating package indices with apt-get update</h4>
<p>Apt contains indices that need to be updated from the upstream repositories</p>
<p><strong>/etc/apt/sources.list</strong> is the main ubuntu repository listing</p>
<p><strong>/etc/apt/sources.list.d</strong> is the directory where additional apt repositories can be added (usually from ppa or 3rd party vendors)</p>
<ul>
<li><a href="http://www.debian.org/mirror/mirrors_full">http://www.debian.org/mirror/mirrors_full</a> for the Debian package mirror sites</li>
<li><a href="http://packages.ubuntu.com/">http://packages.ubuntu.com/</a> for a web ui based search of package details</li>
</ul>
<p>apt-get clean</p>
<blockquote>
<p>/var/cache/apt/archive folder keeps a copy of the downloaded .deb files
you will need an internet connection to download again any removed .deb files</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">lists</span><span class="o">/*</span>
</code></pre></div>

<blockquote>
<p>remove the indices in case they have gotten orphaned or corrupted, needs to be followed by apt-get update to repopulate</p>
</blockquote>
<div class="highlight"><pre><span></span><code>apt-get update
</code></pre></div>

<blockquote>
<p>use /etc/apt/sources.list and /etc/apt/sources.list.d to update the package indices to determine if there are newer packages available</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="k">deb</span> <span class="s">file:///file_store/archive</span> <span class="kp">trusty</span> <span class="kp">main</span> <span class="kp">universe</span>
</code></pre></div>

<blockquote>
<p>a snippet for how to configure apt to use a local repository (e.g. use reprepro to make a local mirror)</p>
</blockquote>
<div class="highlight"><pre><span></span><code>sudo apt-get update -o Dir::Etc::sourcelist=&quot;sources.list.d/example.list&quot; -o Dir::Etc::sourceparts=&quot;-&quot; -o APT::Get::List-Cleanup=&quot;0&quot;
</code></pre></div>

<blockquote>
<p>update only a single repository</p>
</blockquote>
<div class="highlight"><pre><span></span><code>apt-cache dump
</code></pre></div>

<blockquote>
<p>shows all installed packages</p>
</blockquote>
<p>To install netselect, a debian application that allows you to choose the "best" package mirror:
    sudo apt-get install netselect netselect-apt
    netselect-apt</p>
<h4>installing and force installing with apt</h4>
<div class="highlight"><pre><span></span><code>sudo apt-get install --dry-run byobu
</code></pre></div>

<blockquote>
<p>simulate what will happen but do not change the system</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">--</span><span class="n">download</span><span class="o">-</span><span class="n">only</span> <span class="n">byobu</span>
</code></pre></div>

<blockquote>
<p>packages are retrieved but not installed</p>
</blockquote>
<div class="highlight"><pre><span></span><code>sudo apt-get install --yes byobu
</code></pre></div>

<blockquote>
<p>install and pre-emptively answer yes to the yes/no prompt</p>
</blockquote>
<div class="highlight"><pre><span></span><code>sudo apt-get install --reinstall byobu
</code></pre></div>

<blockquote>
<p>reinstall even if the package is installed</p>
</blockquote>
<div class="highlight"><pre><span></span><code>sudo apt-get install --fix-broken byobu
</code></pre></div>

<blockquote>
<p>attempt to fix broken dependencies</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">DEBIAN_FRONTEND</span><span class="o">=</span><span class="n">noninteractive</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span><span class="n">o</span> <span class="n">Dpkg</span><span class="p">::</span><span class="n">Options</span><span class="p">::</span><span class="o">=</span><span class="s">&quot;--force-confdef&quot;</span> <span class="o">-</span><span class="n">o</span> <span class="n">Dpkg</span><span class="p">::</span><span class="n">Options</span><span class="p">::</span><span class="o">=</span><span class="s">&quot;--force-confold&quot;</span> <span class="n">install</span> <span class="o">--</span><span class="n">reinstall</span> <span class="n">byobu</span>
</code></pre></div>

<blockquote>
<p>the most non interactive way to force install a package where all prompts are auto answered such that old configuration files are maintained</p>
</blockquote>
<ul>
<li><a href="http://manpages.ubuntu.com/manpages/precise/man8/apt-get.8.html">http://manpages.ubuntu.com/manpages/precise/man8/apt-get.8.html</a></li>
<li>
<p><a href="https://help.ubuntu.com/community/AptGet/Howto">https://help.ubuntu.com/community/AptGet/Howto</a></p>
<p>apt-get upgrade</p>
<blockquote>
<p>upgrades to the latest version of existing packages, no new packages (so if the new version has new dependencies nothing happens)</p>
</blockquote>
<p>apt-get dist-upgrade</p>
<blockquote>
<p>upgrades to the latest version of existing packages and will try to grab any new dependencies as required</p>
</blockquote>
<p>apt-get install update-manager-core</p>
<blockquote>
<p>newer versions of ubuntu require a helper utility, <a href="http://packages.ubuntu.com/trusty/admin/update-manager-core">http://packages.ubuntu.com/trusty/admin/update-manager-core</a></p>
</blockquote>
</li>
</ul>
<p>Before you do a major upgrade of Ubuntu you should bring all packages to the latest version... (apt-get update &amp;&amp; apt-get dist-upgrade)</p>
<div class="highlight"><pre><span></span><code><span class="k">do</span><span class="o">-</span><span class="nv">release</span><span class="o">-</span><span class="nv">upgrade</span> <span class="o">-</span><span class="nv">f</span> <span class="nv">DistUpgradeViewNonInteractive</span>
</code></pre></div>

<blockquote>
<p>non interactive upgrade to a new version of Ubuntu (hold onto your seat!), often requires a reboot after for kernel upgrades</p>
</blockquote>
<div class="highlight"><pre><span></span><code>lsb_release -a
cat /etc/lsb_release
uname -a
</code></pre></div>

<blockquote>
<p>verify that your system has been upgraded (kernel upgrades often require a reboot to become loaded in memory))</p>
</blockquote>
<h3>removing packages with apt</h3>
<div class="highlight"><pre><span></span><code>apt-get remove wget
</code></pre></div>

<blockquote>
<p>uninstall a package</p>
</blockquote>
<div class="highlight"><pre><span></span><code>apt-get purge wget
</code></pre></div>

<blockquote>
<p>remove the package and all files from disk</p>
</blockquote>
<div class="highlight"><pre><span></span><code>apt-get autoremove
</code></pre></div>

<blockquote>
<p>attempt to clean up packages that are no longer needed (i.e. old versions of dependencies or unused kernel images)</p>
</blockquote>
<h3>apt-key</h3>
<div class="highlight"><pre><span></span><code>sudo apt-key update
</code></pre></div>

<blockquote>
<p>if apt errors: WARNING: The following packages cannot be authenticated</p>
</blockquote>
<h2>dpkg really manages everything</h2>
<p>Underneath apt is dpkg (and similar tools) which actually does all of the hard work but are sometimes hard to use =)</p>
<h3>listing and finding packages with dpkg</h3>
<div class="highlight"><pre><span></span><code>dpkg -l
</code></pre></div>

<blockquote>
<p>lists all of the packages installed (name, version, architecture, description)</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg -l | grep foobar
</code></pre></div>

<blockquote>
<p>lists all of the packages but filters for something specific (i.e. a prefix or partial match)</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg -l packagename &gt; myoutput.txt
</code></pre></div>

<blockquote>
<p>lists whether a specific package is installed or not and redirects the output to a file</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg --get-selections
</code></pre></div>

<blockquote>
<p>lists the package names and the state (installed, uninstalled, etc.)</p>
</blockquote>
<p>dpkg-query -f '${binary:Package}\n' -W</p>
<blockquote>
<p>lists just the package names, slightly more convenient is <code>apt-cache pkgnames | sort</code></p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg -S stdio.h
</code></pre></div>

<blockquote>
<p>find a package that contains a specific file</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg -c packagename.deb
</code></pre></div>

<blockquote>
<p>list the contents of the .deb file</p>
</blockquote>
<p><a href="https://wiki.debian.org/ListInstalledPackages">https://wiki.debian.org/ListInstalledPackages</a></p>
<blockquote>
<p>you can also manually inspect /var/lib/apt and /var/lib/dpkg</p>
</blockquote>
<h4>dpkg logs</h4>
<div class="highlight"><pre><span></span><code><span class="n">vi</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">dpkg</span><span class="o">.</span><span class="n">log</span>
<span class="n">tail</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">dpkg</span><span class="o">.</span><span class="n">log</span>
</code></pre></div>

<blockquote>
<p>in conjunction with <code>apt-get upgrade -y</code></p>
</blockquote>
<h4>Installing and removing packages with dpkg</h4>
<div class="highlight"><pre><span></span><code>dpkg -i packagename.deb
</code></pre></div>

<blockquote>
<p>install the .deb file, <code>dpkg -i *.deb</code> will install all of the .deb files in the current directory</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg -i --force depends packagename.deb
</code></pre></div>

<blockquote>
<p>installs and turns a dependency error into a warning (i.e. libc6 circular dependency)</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg -L packagename
</code></pre></div>

<blockquote>
<p>list the locations of the installed files</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg -s packagename
</code></pre></div>

<blockquote>
<p>shows if the package is installed and information about it, <code>dpkg -s | grep Version</code>
or <code>dpkg -l | awk '$2=="packagename" { print $3 }'</code> to only print the version (if it exists)</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg -r packagename.deb
</code></pre></div>

<blockquote>
<p>remove a package but leave the configuration files, also known as <code>dpkg --remove</code></p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg --purge
</code></pre></div>

<blockquote>
<p>remove a package and delete all configuration files (even if they have been customized by the user)</p>
</blockquote>
<div class="highlight"><pre><span></span><code>dpkg --force-help
</code></pre></div>

<h4>to manually install a package (forcefully if synaptic and apt-get are stuck)</h4>
<div class="highlight"><pre><span></span><code><span class="n">mv</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpkg</span><span class="o">/</span><span class="n">info</span><span class="o">/</span><span class="n">postgresql</span><span class="o">.*</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span>
<span class="n">dpkg</span> <span class="o">--</span><span class="n">remove</span> <span class="o">--</span><span class="n">force</span><span class="o">-</span><span class="n">remove</span><span class="o">-</span><span class="n">reinstreq</span> <span class="n">postgresql</span><span class="o">-</span><span class="mf">9.1</span>
</code></pre></div>

<blockquote>
<p>do the same for postgresql-common and other packages</p>
</blockquote>
<p>apt-get install postgresql-9.1
apt-get purge postgresql-9.1 postgresql-client-9.1 postgresql-common postgresql-client-common</p>
<blockquote>
<p>in order to have apt-get remove all of the binaries</p>
</blockquote>
<h2>Best Ubuntu Packages</h2>
<blockquote>
<p>as of Utopic 14.10</p>
</blockquote>
<div class="highlight"><pre><span></span><code>sudo apt-get update
sudo apt-get install -y byobu build-essential elinks unzip unrar vim wget curl ntp rcconf dialog git-core 
sudo apt-get install -y python-pip &amp;&amp; sudo pip install --upgrade pip
</code></pre></div>

<blockquote>
<p>pip is the package manager for python packages (different from the debian OS packages) so useful if you do any python development or run python applications
An alternative to the usually stale OS pip version is to use the not entirely secure grab the .py file from the internet and run it...
wget -qO- https://bootstrap.pypa.io/get-pip.py | sudo python</p>
</blockquote>
<ul>
<li>openssh-server libssl = the secure remote shell service and encryption dependency <a href="http://packages.ubuntu.com/search?keywords=openssh-server">http://packages.ubuntu.com/search?keywords=openssh-server</a></li>
<li>build-essential = tools for compiling and building debian packages <a href="http://packages.ubuntu.com/lucid/build-essential">http://packages.ubuntu.com/lucid/build-essential</a></li>
<li>byobu = console terminal multi screen (survives network disconnects) <a href="http://byobu.co">http://byobu.co</a></li>
<li>
<p>wget and curl = utilities to download files over the network</p>
</li>
<li>
<p>elinks = cli browser (just in case your GUI dies and you need to research) <a href="http://kmandla.wordpress.com/2011/01/13/a-comparison-of-text-based-browsers">http://kmandla.wordpress.com/2011/01/13/a-comparison-of-text-based-browsers</a></p>
</li>
<li>unzip and unrar = utilities to decompress compressed things</li>
<li>ntp = network time protocol client daemon to keep your clock in sync</li>
<li>rcconf = easier way to manage what services start at boot <a href="https://packages.debian.org/jessie/rcconf">https://packages.debian.org/jessie/rcconf</a></li>
<li>
<p>dialog = user friendly dialog boxes for shell scripts (dependency for rcconf)</p>
</li>
<li>
<p>git-core = the distributed version control software that is eating the developer world</p>
</li>
<li>
<p>python-setuptools = Sometimes required to install pip  <a href="http://pythonhosted.org/setuptools">http://pythonhosted.org/setuptools</a></p>
</li>
<li>
<p>nano = a simple text editor (much easier than vi/vim for just writing new text)</p>
</li>
</ul>
<p>sudo apt-get install openconnect network-manager-openconnect network-manager-openconnect-gnome</p>
<ul>
<li>
<p>openconnect = opensource compatible with cisco anyconnect vpn <a href="https://en.wikipedia.org/wiki/OpenConnect">https://en.wikipedia.org/wiki/OpenConnect</a></p>
</li>
<li>
<p>openvpn = opensource vpn client <a href="https://openvpn.net">https://openvpn.net</a></p>
<p>sudo apt-get install openjdk-8-jre</p>
<blockquote>
<p>for just the java runtime (thank goodness not Oracle Sun)</p>
</blockquote>
</li>
<li>
<p>jdk = java development kit</p>
</li>
<li>iced-tea-7-plugin = open source java 7 support for browsers</li>
<li>icedtea = open java (plugin = browser java)</li>
</ul>
<p>openjdk-8-jdk</p>
<blockquote>
<p>for the full java development kit - needed for some packages to run correctly</p>
</blockquote>
<h3>GUI</h3>
<p><strong>Xubuntu Desktop</strong> is my preferred "lightweight" GUI for Ubuntu: <a href="http://xubuntu.org">http://xubuntu.org</a></p>
<div class="highlight"><pre><span></span><code>apt-get install -y chromium-browser pepperflashplugin-nonfree geany keepassx xdiskusage
apt-get install -y arandr rdesktop
</code></pre></div>

<ul>
<li>chromium-browser = opensource branch/clone of google chrome browser, </li>
<li>
<ul>
<li>maybe srware.net with privacy badger and adblock plus (fanboy block lists) too?</li>
</ul>
</li>
<li>geany = tabbed text notepad (with syntax highlighting)</li>
<li>keepassx = secure password inventory (has a mini version for iphone as well)</li>
<li>xdiskusage = graphical view of disk space usage by folder and file</li>
<li>
<p>arandr = multi display gui config</p>
</li>
<li>
<p>rdesktop = RDP client</p>
</li>
<li>
<p>grdesktop = gnome UI for rdesktop</p>
<p>sudo echo "autologin-user=ubuntu" &gt;&gt;  /etc/lightdm/lightdm.conf.d/10-xubuntu.conf</p>
<blockquote>
<p>Better yet use the UI and just choose auto login ;)</p>
</blockquote>
</li>
</ul>
<p>TODO: <em>Disable guest user</em>, *Disable crash reports: apport *</p>
<ul>
<li>
<p>imagemagick = image transformation utility <a href="https://en.wikipedia.org/wiki/ImageMagick">https://en.wikipedia.org/wiki/ImageMagick</a></p>
<blockquote>
<p><code>convert -resize 50% source.png dest.jpg ; convert -rotate 90 source.jpg dest.jpg</code></p>
</blockquote>
</li>
<li>
<p>dropbox = cloud file storage</p>
<p>deb http://linux.dropbox.com/ubuntu utopic main
sudo apt-key adv --keyserver pgp.mit.edu --recv-keys 5044912E</p>
<div class="highlight"><pre><span></span><code><span class="k">deb</span> <span class="s">http://downloads.hipchat.com/linux/apt</span> <span class="kp">stable</span> <span class="kp">main</span>
<span class="err">wget</span> <span class="err">-O</span> <span class="err">-</span> <span class="err">https://www.hipchat.com/keys/hipchat-linux.key</span> <span class="err">|</span> <span class="err">apt-key</span> <span class="err">add</span> <span class="err">-</span>
</code></pre></div>

<p>apt-get update; apt-get install dropbox hipchat</p>
</li>
<li>
<p>filezilla = file transfer protocol client (that supports sftp = secure ssh ftp)</p>
</li>
</ul>
<h3>music and video</h3>
<div class="highlight"><pre><span></span><code>sudo apt-get install ubuntu-restricted-extras vlc
</code></pre></div>

<ul>
<li>vlc = movies/music</li>
<li>ubuntu-restricted-extras = all of the encumbered with licenses packages to generally just watch or listen to stuff :(</li>
</ul>
<h4>Google Music Manager</h4>
<p>If you are you using the web based <a href="https://play.google.com/music/listen#/all">https://play.google.com/music/listen#/all</a> then you probably want the uploader/downloader:</p>
<div class="highlight"><pre><span></span><code>wget https://dl.google.com/linux/direct/google-musicmanager-beta_current_amd64.deb
dpkg -i google-musicmanager-beta_current_amd64.deb
</code></pre></div>

<h4>spotify in ubuntu 15.04</h4>
<p><a href="https://www.spotify.com/us/download/linux/">https://www.spotify.com/us/download/linux/</a></p>
<div class="highlight"><pre><span></span><code>sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys D2C19886
</code></pre></div>

<blockquote>
<p>trust the spotify repository</p>
<p>libnss3-1d : Depends: libnss3 (= 2:3.17.4-0ubuntu1) but 2:3.19.2-0ubuntu15.04.1 is to be installed
spotify is behind the times or only wants to support 14.04 and LTS releases =(</p>
</blockquote>
<p><a href="https://launchpad.net/ubuntu/vivid/amd64/libnss3/2:3.17.4-0ubuntu1">https://launchpad.net/ubuntu/vivid/amd64/libnss3/2:3.17.4-0ubuntu1</a>
<a href="https://launchpad.net/ubuntu/wily/amd64/libnss3/2:3.19.2.1-0ubuntu0.15.10.1">https://launchpad.net/ubuntu/wily/amd64/libnss3/2:3.19.2.1-0ubuntu0.15.10.1</a></p>
<div class="highlight"><pre><span></span><code><span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="n">libnss3_3</span><span class="o">.</span><span class="mf">17.4</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1_amd64</span><span class="o">.</span><span class="n">deb</span>
<span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">spotify</span><span class="o">-</span><span class="n">client</span>
<span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="o">-</span><span class="n">f</span> <span class="n">install</span>

<span class="n">spotify</span><span class="p">:</span> <span class="n">error</span> <span class="k">while</span> <span class="n">loading</span> <span class="n">shared</span> <span class="n">libraries</span><span class="p">:</span> <span class="n">libgcrypt</span><span class="o">.</span><span class="n">so</span><span class="o">.</span><span class="mi">11</span><span class="p">:</span> <span class="n">cannot</span> <span class="n">open</span> <span class="n">shared</span> <span class="n">object</span> <span class="n">file</span><span class="p">:</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span>
</code></pre></div>

<blockquote>
<p>what fun, the internet explains 15.04 (vivid) and 15.10 (wily) use the new libgcrypt20 so...</p>
</blockquote>
<div class="highlight"><pre><span></span><code>wget https://launchpad.net/ubuntu/+archive/primary/+files/libgcrypt11_1.5.3-2ubuntu4.2_amd64.deb
dpkg -i libgcrypt*.deb
apt-get install --reinstall spotify-client
</code></pre></div>

<h4>pithos is an open source pandora client</h4>
<ul>
<li><code>sudo add-apt-repository ppa:pithos/ppa</code></li>
<li><code>sudo apt-get install pithos</code></li>
</ul>
<h4>more codecs and DVD playback</h4>
<div class="highlight"><pre><span></span><code>sudo apt-get install ffmpeg gstreamer0.10-plugins-bad lame libavcodec-extra
sudo /usr/share/doc/libdvdread4/install-css.sh
</code></pre></div>

<h2>Packages you will probably want to remove</h2>
<div class="highlight"><pre><span></span><code>apt-get remove brltty
</code></pre></div>

<blockquote>
<p>unless you are using braille on your computer</p>
</blockquote>
<h2>Other Useful Packages</h2>
<h3>Heroku CLI</h3>
<ul>
<li>deb http://toolbelt.heroku.com/ubuntu ./</li>
<li>wget -O- https://toolbelt.heroku.com/apt/release.key | apt-key add -</li>
<li><code>apt-get install -y heroku-toolbelt</code></li>
</ul>
<h3>Ruby and OpenShift CLI</h3>
<p>https://gorails.com/setup/ubuntu/14.04</p>
<p><code>sudo apt-get install git-core curl zlib1g-dev build-essential libssl-dev libreadline-dev libyaml-dev libsqlite3-dev sqlite3 \</code>
  <code>libxml2-dev libxslt1-dev libcurl4-openssl-dev python-software-properties libgdbm-dev libncurses5-dev automake libtool bison libffi-dev</code></p>
<div class="highlight"><pre><span></span><code>source ~/.rvm/scripts/rvm
echo &quot;source ~/.rvm/scripts/rvm&quot; &gt;&gt; ~/.bashrc
rvm install 2.1.2
rvm use 2.1.2 --default
ruby -v
echo &quot;gem: --no-ri --no-rdoc&quot; &gt; ~/.gemrc

gem install rhc
</code></pre></div>

<blockquote>
<p>red hat client for openshift</p>
</blockquote>
<h2>SSD Optimization</h2>
<h3>Write Logs to tmpfs instead of disk</h3>
<p>tmpfs ram (memory) virtual disk will just use memory (which I guess is overly abundant now) instead of wearing out the Solid State Drive</p>
<div class="highlight"><pre><span></span><code><span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>


<span class="c1"># /etc/fstab: static file system information.</span>
<span class="c1">#</span>
<span class="c1"># Use &#39;blkid&#39; to print the universally unique identifier for a</span>
<span class="c1"># device; this may be used with UUID= as a more robust way to name devices</span>
<span class="c1"># that works even if disks are added and removed. See fstab(5).</span>
<span class="c1">#</span>
<span class="c1"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span>
<span class="c1"># / was on /dev/sda2 during installation</span>
<span class="n">UUID</span><span class="o">=</span><span class="n">b7577587</span><span class="o">-</span><span class="mi">22</span><span class="n">db</span><span class="o">-</span><span class="mi">42</span><span class="n">f6</span><span class="o">-</span><span class="mi">95</span><span class="n">d1</span><span class="o">-</span><span class="mi">264</span><span class="n">a24f9dd90</span> <span class="o">/</span>               <span class="n">ext4</span>    <span class="n">noatime</span><span class="p">,</span><span class="n">errors</span><span class="o">=</span><span class="n">remount</span><span class="o">-</span><span class="n">ro</span> <span class="mi">0</span>       <span class="mi">1</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="n">tmp</span>        <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">tmp</span>    <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">apparmor</span>    <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">apt</span>    <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">cups</span>    <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">upgrade</span> <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">installer</span> <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">lightdm</span>  <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">unattended</span><span class="o">-</span><span class="n">upgrades</span> <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
</code></pre></div>

<blockquote>
<p>the tmpfs disks created in my fstab were discovered through trial and error and will differ based on what applications are actually running (Xubuntu!)</p>
<p>an older simpler example causes errors as applications create /var/log/SOMETHING directories during installation and then expect them on boot every time later</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span> <span class="o">/</span>     <span class="n">ext4</span>    <span class="n">noatime</span><span class="p">,</span><span class="n">errors</span><span class="o">=</span><span class="n">remount</span><span class="o">-</span><span class="n">ro</span> <span class="mi">0</span> <span class="mi">1</span>

<span class="n">tmpfs</span>    <span class="o">/</span><span class="n">tmp</span>        <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">tmp</span>    <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
<span class="n">tmpfs</span>    <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span>    <span class="n">tmpfs</span>    <span class="n">defaults</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">0</span>  <span class="mi">0</span>
</code></pre></div>

<blockquote>
<p>here is a list of directories that probably need to be generated
<em>for dir in apparmor apt cups dist-upgrade fsck gdm installer news samba unattended-upgrades ; do</em>
*  mkdir -p /var/log/$dir<em>
</em>done*</p>
</blockquote>
<h3>Customize Grub Boot Options</h3>
<p>I prefer seeing my bootup screens so I remove some but add the SSD enhancement</p>
<div class="highlight"><pre><span></span><code>vi nano /etc/default/grub
    GRUB_TIMEOUT=1
    #   GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet splash&quot;
    GRUB_CMDLINE_LINUX_DEFAULT=&quot;elevator=noop&quot;

sudo update-grub2
cat /boot/grub/grub.cfg
    root=UUID=f0ae2c59-83d2-42e7-81c4-2e870b6b255d ro quiet splash elevator=noop
</code></pre></div>

<blockquote>
<p>only prompt for 1 second
remove the quiet so the console displays all of the boot information
the noop scheduler is a simple FIFO scheduler which is usually optimal for SSD or virtual machines <a href="https://en.wikipedia.org/wiki/Noop_scheduler">https://en.wikipedia.org/wiki/Noop_scheduler</a> since any OS attempt at optimization may cnoflict with more accurate information from the Disk or Hypervisor
update-grub2 is to apply the update <a href="https://help.ubuntu.com/community/Grub2">https://help.ubuntu.com/community/Grub2</a>
manually verify the changes by examining all of the boot menu options (i.e. find the noop line)</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">block</span><span class="o">/</span><span class="n">sda</span><span class="o">/</span><span class="n">queue</span><span class="o">/</span><span class="n">scheduler</span><span class="w"></span>
<span class="w">    </span><span class="o">[</span><span class="n">noop</span><span class="o">]</span><span class="w"> </span><span class="n">deadline</span><span class="w"> </span><span class="n">cfq</span><span class="w"></span>
</code></pre></div>

<blockquote>
<p>list what schedulers are available , <a href="http://www.linuxhowtos.org/System/iosched.htm">http://www.linuxhowtos.org/System/iosched.htm</a>, note that noop is selected</p>
</blockquote>
<p><em>Note: the above command needs to be run as root, but sudo does not work with it on my system. Run sudo -i if you have a problem to get a root prompt.)</em></p>
<h2>Good Digital Ocean Droplet Tips</h2>
<ol>
<li><code>useradd -s /bin/bash -m NEWUSERNAME</code></li>
<li><code>usermod -a -G admin NEWUSERNAME</code></li>
<li><code>passwd NEWUSERNAME</code></li>
<li>mkdir -p /home/NEWUSERNAME/.ssh</li>
<li>vi /home/NEWUSERNAME/.ssh/authorized_keys</li>
<li>visudo
    <code>#includedir /etc/sudoers.d</code>
    <code>NEWUSERNAME    ALL = (ALL) NOPASSWD: ALL</code></li>
</ol>
<blockquote>
<p>of course set the timezone to UTC and use network time protocol</p>
</blockquote>
<ol>
<li>dpkg-reconfigure tzdata</li>
<li>apt-get update</li>
<li>apt-get install byobu vim ntp</li>
<li>Secure SSH by removing root login with vi /etc/ssh/sshd_config: <code>PermitRootLogin no</code> , <code>PasswordAuthentication no</code></li>
<li>Optionally change the SSH port to something different from the default: <code>Port 22</code></li>
<li>/etc/init.d/ssh restart</li>
</ol>
<p>Use the Digital Ocean Web UI to poweroff and take a snapshot of the fresh system</p>
            <aside>
            <hr/>
            <nav>
            <ul class="articles_timeline">
 
                <li class="previous_article">« <a href="https://blog.john-pfeiffer.com/listjs-sort-filters-search-and-more-for-html-lists-and-tables-in-javascript/" title="Previous: ListJS: Sort, Filters, Search and more for HTML lists and tables in Javascript">ListJS: Sort, Filters, Search and more for HTML lists and tables in Javascript</a></li>
 
                <li class="next_article"><a href="https://blog.john-pfeiffer.com/fix-fn-screen-brightness-ubuntu-1404-intel-graphics/" title="Next: Fix Fn screen brightness Ubuntu 14.04 intel graphics">Fix Fn screen brightness Ubuntu 14.04 intel graphics</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
 
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2014-08-20T00:00:00-07:00">Aug 20, 2014</time>
            <h4>Category</h4>
            <a class="category-link" href="/categories.html#linux-ref">linux</a> 
            <h4>~2409 words</h4>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article"> 
                <li><a href="/tags.html#apt-get-ref">apt-get
                    <span>1</span>
</a></li>
                <li><a href="/tags.html#dd-ref">dd
                    <span>2</span>
</a></li>
                <li><a href="/tags.html#dpkg-ref">dpkg
                    <span>1</span>
</a></li>
                <li><a href="/tags.html#linux-ref">linux
                    <span>11</span>
</a></li>
                <li><a href="/tags.html#ubuntu-ref">ubuntu
                    <span>3</span>
</a></li>
                <li><a href="/tags.html#ubuntu-recovery-ref">ubuntu recovery
                    <span>1</span>
</a></li>
                <li><a href="/tags.html#usb-boot-ref">usb boot
                    <span>1</span>
</a></li>
                <li><a href="/tags.html#xubuntu-ref">xubuntu
                    <span>1</span>
</a></li>
            </ul>

        </div>
        </section>
</div>
</article>
				</div>
				<div class="span1"></div>
			</div>
		</div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
    </ul>
</div>
</footer>            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    </body>
</html>